<!DOCTYPE html>
<html lang="en-us"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
   <meta name="description" content="ì´ ê¸€ì€ ì›¹ ì„œë¹„ìŠ¤ê°€ ì œê³µë˜ê¸° ìœ„í•œ ì „ì²´ì ì¸ ì¸í”„ë¼ êµ¬ì„±ì„ ì—°ìŠµí•˜ê¸° ìœ„í•œ ë°±ì—”ë“œ ê°œë°œìì˜ ë°œë²„ë‘¥ì´ ë‹´ê¸° ê¸€ì…ë‹ˆë‹¤.
ë“¤ì–´ê°€ë©° ì—…ë¬´ë¥¼ í•˜ë‹¤ë³´ë©´ ì§€ê¸ˆ ë‹¤ë¥¸ íŒ€ì›ë“¤ì— ë¹„í•´ì„œ ì¸í”„ë¼ ì—­ëŸ‰ì´ ë§ì´ ë–¨ì–´ì§„ë‹¤ëŠ” ìƒê°ì„ ë§ì´ ë“¤ê²Œ ëœë‹¤. ê°€ë” ì½”ë“œì—ì„œ ë°œìƒí•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, HTTP ì‘ë‹µì´ë‚˜ ì™¸ë¶€ ì„œë¹„ìŠ¤ ì—°ê²° ë¬¸ì œë¡œ ì¸í•´ ë¬¸ì œê°€ ë°œìƒí–ˆì„ ë•Œ ì¸í”„ë¼ì— ëŒ€í•œ ì „ì²´ì ì¸ ê·¸ë¦¼ì´ ì—†ìœ¼ë‹ˆ ë¬´ì§€ì„±ìœ¼ë¡œ DevOps íŒ€ì— ìš”ì²­í•˜ëŠ” ì¼ì´ ì¢…ì¢… ìˆì—ˆë‹¤.
ì‚¬ì‹¤ ì¸í”„ë¼ì ì¸ ì§€ì‹ì´ ìˆì—ˆë‹¤ë©´ ì§ì ‘ ì„¤ì •ì„ ìˆ˜ì •í•˜ì§€ëŠ” ëª»í•´ë„ ì„¤ì •ëœ ê°’ë“¤ê³¼ ì—°ê´€ ê´€ê³„ë¥¼ ì´í•´í•˜ë©´, ì–´ëŠ ì§€ì ì—ì„œ ë¬¸ì œê°€ ë°œìƒí•˜ê³  ìˆëŠ”ì§€ ì•Œ ìˆ˜ ìˆê³ , ì½”ë“œ êµ¬ì¡° ë¿ë§Œ ì•„ë‹ˆë¼ ì¸í”„ë¼ êµ¬ì¡°ë¥¼ ê·¸ë¦´ ìˆ˜ ìˆë‹¤ë©´ ë” íš¨ìœ¨ì ì¸ ë¬¸ì œí•´ê²° ë°©ë²•ì„ ë– ì˜¤ë¥¼ ìˆ˜ ìˆì§€ë§Œ, ì§€ê¸ˆì€ ì½”ë“œ êµ¬ì¡° ì•ˆì—ì„œ ë¬¸ì œë¥¼ í•´ê²°í•˜ë ¤ëŠ” ìƒê°ì´ ë” ê°•í•˜ë‹¤ëŠ” ëŠë‚Œì´ ë“¤ì—ˆë‹¤.">  

  <title>
    
      ì›¹ ì„œë¹„ìŠ¤ ì¸í”„ë¼ êµ¬ì„± ì—°ìŠµì¥
    
  </title>


  <link rel="shortcut icon" type="image/x-icon" href="/" />
  
  
  
  <link rel="stylesheet" href="/css/main.10776b9b86bf7e3aca232a6c5e4fbdc3baacf45c0cc3a1802995836aa1689368e8fadebd3e46fdc9ad87eab1f834f5bbb28dbb2b23fea73ae3e57c258caef3bd.css" integrity="sha512-EHdrm4a/fjrKIypsXk&#43;9w7qs9FwMw6GAKZWDaqFok2jo&#43;t69Pkb9ya2H6rH4NPW7so27KyP&#43;pzrj5XwljK7zvQ==" />
  
</head>
<body a="auto">
        <main class="page-content" aria-label="Content">
            <div class="w">
<a href="/">..</a>

<article>
    <p class="post-meta">
        <time datetime="2023-07-20 11:06:31 &#43;0900 KST">
            2023-07-20
        </time>
    </p>

    <h1>ì›¹ ì„œë¹„ìŠ¤ ì¸í”„ë¼ êµ¬ì„± ì—°ìŠµì¥</h1>

    

    <blockquote>
<p>ì´ ê¸€ì€ ì›¹ ì„œë¹„ìŠ¤ê°€ ì œê³µë˜ê¸° ìœ„í•œ ì „ì²´ì ì¸ ì¸í”„ë¼ êµ¬ì„±ì„ ì—°ìŠµí•˜ê¸° ìœ„í•œ ë°±ì—”ë“œ ê°œë°œìì˜ ë°œë²„ë‘¥ì´ ë‹´ê¸° ê¸€ì…ë‹ˆë‹¤.</p>
</blockquote>
<h2 id="ë“¤ì–´ê°€ë©°">ë“¤ì–´ê°€ë©°</h2>
<p>ì—…ë¬´ë¥¼ í•˜ë‹¤ë³´ë©´ ì§€ê¸ˆ ë‹¤ë¥¸ íŒ€ì›ë“¤ì— ë¹„í•´ì„œ ì¸í”„ë¼ ì—­ëŸ‰ì´ ë§ì´ ë–¨ì–´ì§„ë‹¤ëŠ” ìƒê°ì„ ë§ì´ ë“¤ê²Œ ëœë‹¤. ê°€ë” ì½”ë“œì—ì„œ ë°œìƒí•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, HTTP ì‘ë‹µì´ë‚˜ ì™¸ë¶€ ì„œë¹„ìŠ¤ ì—°ê²° ë¬¸ì œë¡œ ì¸í•´ ë¬¸ì œê°€ ë°œìƒí–ˆì„ ë•Œ ì¸í”„ë¼ì— ëŒ€í•œ ì „ì²´ì ì¸ ê·¸ë¦¼ì´ ì—†ìœ¼ë‹ˆ ë¬´ì§€ì„±ìœ¼ë¡œ DevOps íŒ€ì— ìš”ì²­í•˜ëŠ” ì¼ì´ ì¢…ì¢… ìˆì—ˆë‹¤.</p>
<p>ì‚¬ì‹¤ ì¸í”„ë¼ì ì¸ ì§€ì‹ì´ ìˆì—ˆë‹¤ë©´ ì§ì ‘ ì„¤ì •ì„ ìˆ˜ì •í•˜ì§€ëŠ” ëª»í•´ë„ ì„¤ì •ëœ ê°’ë“¤ê³¼ ì—°ê´€ ê´€ê³„ë¥¼ ì´í•´í•˜ë©´, ì–´ëŠ ì§€ì ì—ì„œ ë¬¸ì œê°€ ë°œìƒí•˜ê³  ìˆëŠ”ì§€ ì•Œ ìˆ˜ ìˆê³ , ì½”ë“œ êµ¬ì¡° ë¿ë§Œ ì•„ë‹ˆë¼ ì¸í”„ë¼ êµ¬ì¡°ë¥¼ ê·¸ë¦´ ìˆ˜ ìˆë‹¤ë©´ ë” íš¨ìœ¨ì ì¸ ë¬¸ì œí•´ê²° ë°©ë²•ì„ ë– ì˜¤ë¥¼ ìˆ˜ ìˆì§€ë§Œ, ì§€ê¸ˆì€ ì½”ë“œ êµ¬ì¡° ì•ˆì—ì„œ ë¬¸ì œë¥¼ í•´ê²°í•˜ë ¤ëŠ” ìƒê°ì´ ë” ê°•í•˜ë‹¤ëŠ” ëŠë‚Œì´ ë“¤ì—ˆë‹¤.</p>
<p>ê·¸ë˜ì„œ ì´ë²ˆì— ê¸°ì´ˆì ì¸ í´ë¼ìš°ë“œ í™˜ê²½ì—ì„œ ìš´ì˜ë˜ëŠ” ì›¹ ì„œë¹„ìŠ¤ ì¸í”„ë¼ êµ¬ì¡°ë¥¼ ì§ì ‘ êµ¬ì„±í•´ë³´ë©´ì„œ AWSì—ì„œ ì œê³µë˜ëŠ” ë‹¤ì–‘í•œ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•´ë³´ëŠ” ì‹œê°„ì„ ê°€ì§€ë ¤ê³  í•œë‹¤. ë¸Œë¼ìš°ì €ë¥¼ í†µí•´ì„œ ì„¤ì •í•˜ëŠ” ê²ƒë„ ì¢‹ì€ ê¸°íšŒì§€ë§Œ ë‚˜ëŠ” êµ¬ì„±í•˜ê³  ë¹ ë¥´ê²Œ ë‹¤ì‹œ ì›ë³µ(êµ¬ì„±ëœ ë™ì•ˆ ë¹„ìš©ì´ ê³„ì† ë°œìƒí•˜ë‹ˆê¹&hellip; ğŸ¤£) ì„ í•´ì•¼í•˜ê¸° ë•Œë¬¸ì— Terraformì„ ì´ìš©í•´ ë³´ê¸°ë¡œ í–ˆë‹¤.</p>
<p><img src="https://i.imgur.com/2TYgsGR.png" alt="img"></p>
<p>ëª©í‘œëŠ” AWS ë¬¸ì„œì—ì„œ ì‘ì„±ëœ í˜•íƒœë¡œ êµ¬ì„±í•´ë³¼ ì˜ˆì •ì´ë‹¤. ì´ êµ¬ì¡°ë¥¼ ì„ íƒí•œ ì´ìœ ëŠ” ì¼ë‹¨ í•™ìŠµ ëª©ì ì„ ìš°ì„ ìœ¼ë¡œ í•˜ì—¬ ìµœëŒ€í•œ ë§ì€ AWS ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•´ë³´ê³  ë³µì¡í•œ ì¸í”„ë¼ êµ¬ì¡°ë¥¼ êµ¬ì„±í•´ë³´ëŠ” ê²½í—˜ì´ í•„ìš”í•˜ê¸° ë•Œë¬¸ì´ë‹¤. ë§ˆì§€ë§‰ìœ¼ë¡œ ê° ì„œë¹„ìŠ¤ì˜ í•„ìš”ì„±ì„ í•™ìŠµ í•˜ë©´ì„œ ë§ˆë¬´ë¦¬ë¥¼ í•  ì˜ˆì •ì´ë‹¤.</p>
<h2 id="private-key-ìƒì„±">Private key ìƒì„±</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>resource <span style="color:#e6db74">&#34;tls_private_key&#34;</span> <span style="color:#e6db74">&#34;application_private_key&#34;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  algorithm <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;RSA&#34;</span>
</span></span><span style="display:flex;"><span>  rsa_bits  <span style="color:#f92672">=</span> <span style="color:#ae81ff">4096</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>resource <span style="color:#e6db74">&#34;aws_key_pair&#34;</span> <span style="color:#e6db74">&#34;application_key_pair&#34;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  key_name   <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;application-key-pair&#34;</span> <span style="color:#75715e"># Replace with your desired key pair name</span>
</span></span><span style="display:flex;"><span>  public_key <span style="color:#f92672">=</span> tls_private_key.application_private_key.public_key_openssh
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>EC2 instanceë¥¼ ì‹¤í–‰í•˜ê¸° ì „ ì›ê²© ì„œë²„ì— ì ‘ì†í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë  ìˆ˜ ìˆëŠ” ë¹„ë°€í‚¤/ê³µê°œí‚¤ í˜•íƒœì˜ ì•”í˜¸í™” í‚¤ë¥¼ ìƒì„±í•  í•„ìš”ê°€ ìˆë‹¤. terraformì€ <code>tls_private_key</code>ì™€ <code>aws_key_pair</code> ë¦¬ì†ŒìŠ¤ë¥¼ ì´ìš©í•´ ê°„ë‹¨íˆ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤.</p>
<h2 id="vpc">VPC</h2>
<p>VPCëŠ” ë„¤íŠ¸ì›Œí¬ ì˜ì—­ì„ ë…¼ë¦¬ì ì¸ ë‹¨ìœ„ë¡œ ë¶„ë¦¬í•˜ëŠ” ê²ƒìœ¼ë¡œ ì‚¬ìš©ìëŠ” ì´ë¥¼ í†µí•´ì„œ Private/Public network zoneì„ êµ¬ì„±í•  ìˆ˜ ìˆê²Œ ëœë‹¤.  ì‚¬ìš©ìëŠ” ì„œë¹„ìŠ¤ ì„±ê²©ì— ë§ê²Œ ì™¸ë¶€ ì ‘ê·¼ì„ ê´€ë¦¬í•  ìˆ˜ ìˆìœ¼ë©° ë¬¼ë¦¬ì ì¸ ë„¤íŠ¸ì›Œí¬ êµ¬ì„±ì„ ì„¤ì¹˜í•  í•„ìš”ì—†ì´ í•˜ë‚˜ì˜ ë„¤íŠ¸ì›Œí¬ë§ ì•ˆì—ì„œ ë§ˆì¹˜ ì—¬ëŸ¬ ë„¤íŠ¸ì›Œí¬ë¥¼ ì´ìš©í•˜ëŠ” ê²ƒì²˜ëŸ¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ë¹„ìš©ì ì¸ ë¶€ë¶„ê³¼ ê´€ë¦¬ ì¸¡ë©´ì—ì„œë„ ë§¤ìš° íš¨ê³¼ì ì¸ ë°©ë²•ì´ë¼ê³  ìƒê°ëœë‹¤.</p>
<p>ì´ë²ˆì—ëŠ” DMZ(Demilitarized Zone)ì™€ Applicationìœ¼ë¡œ VPCë¥¼ êµ¬ë¶„í•´ì„œ êµ¬ì„±í•  ì˜ˆì •ì´ë‹¤. ì—¬ê¸°ì„œ DMZëŠ” ì‹ ë¢°í•  ìˆ˜ ì—†ëŠ” ì™¸ë¶€ ì˜ì—­ê³¼ ë‚´ë¶€ ì˜ì—­ ì‚¬ì´ì— ìœ„ì¹˜í•œ ë„¤íŠ¸ì›Œí¬ ì˜ì—­ìœ¼ë¡œ ì´ ì˜ì—­ì€ ì™¸ë¶€ì—ì„œ ë‚´ë¶€ë¡œ ì „ë‹¬ë˜ëŠ” ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ì— ëŒ€í•œ ë³´ì•ˆ ë° ë²„í¼ ì—­í• ì„ í•˜ê²Œëœë‹¤. ì´ë¡œì„œ DMZì—ëŠ” ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ì™€ ë‹¤ë¥¸ ë³´ì•ˆ ì •ì±…ì„ êµ¬ì„±í•  ìˆ˜ ìˆë‹¤.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>resource <span style="color:#e6db74">&#34;aws_vpc&#34;</span> <span style="color:#e6db74">&#34;dmz&#34;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  cidr_block           <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;10.1.0.0/16&#34;</span>
</span></span><span style="display:flex;"><span>  enable_dns_support   <span style="color:#f92672">=</span> true
</span></span><span style="display:flex;"><span>  enable_dns_hostnames <span style="color:#f92672">=</span> true
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>resource <span style="color:#e6db74">&#34;aws_vpc&#34;</span> <span style="color:#e6db74">&#34;application&#34;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  cidr_block           <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;10.2.0.0/16&#34;</span>
</span></span><span style="display:flex;"><span>  enable_dns_support   <span style="color:#f92672">=</span> true
</span></span><span style="display:flex;"><span>  enable_dns_hostnames <span style="color:#f92672">=</span> true
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>ì°¸ê³ í•œ ë¸”ë¡œê·¸ì—ì„œ VPC ë‚´ ë™ì¼í•œ CIRD blockìœ¼ë¡œ êµ¬ì„±í•˜ë©´ ì´í›„ VPC connection peeringì´ ì–´ë ¤ìš¸ ìˆ˜ ìˆë‹¤ê³  ë“¤ì–´ì„œ ê°ê° <code>10.1.0.0/16</code>, <code>10.2.0.0./16</code>ìœ¼ë¡œ êµ¬ì„±í–ˆë‹¤.</p>
<h3 id="subnet">Subnet</h3>
<p>Subnet(ì´í•˜, ì„œë¸Œë„·)ì€ VPCë¥¼ ë” ì‘ì€ ì˜ì—­ìœ¼ë¡œ êµ¬ë¶„í•  ìˆ˜ ìˆë‹¤. ì„œë¸Œë„·ì€ VPCì˜ IP ì£¼ì†Œ ë²”ìœ„ ë‚´ì—ì„œ ì˜ê²Œ êµ¬ë¶„ë  ìˆ˜ ìˆë‹¤.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># DMZ Public Subnets</span>
</span></span><span style="display:flex;"><span>resource <span style="color:#e6db74">&#34;aws_subnet&#34;</span> <span style="color:#e6db74">&#34;dmz_public_primary&#34;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  vpc_id            <span style="color:#f92672">=</span> aws_vpc.dmz.id
</span></span><span style="display:flex;"><span>  cidr_block        <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;10.1.1.0/24&#34;</span>
</span></span><span style="display:flex;"><span>  availability_zone <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ap-northeast-2a&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>resource <span style="color:#e6db74">&#34;aws_subnet&#34;</span> <span style="color:#e6db74">&#34;dmz_public_secondery&#34;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  vpc_id            <span style="color:#f92672">=</span> aws_vpc.dmz.id
</span></span><span style="display:flex;"><span>  cidr_block        <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;10.1.2.0/24&#34;</span>
</span></span><span style="display:flex;"><span>  availability_zone <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ap-northeast-2c&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Application Public Subnets</span>
</span></span><span style="display:flex;"><span>resource <span style="color:#e6db74">&#34;aws_subnet&#34;</span> <span style="color:#e6db74">&#34;application_public_primary&#34;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  vpc_id            <span style="color:#f92672">=</span> aws_vpc.application.id
</span></span><span style="display:flex;"><span>  cidr_block        <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;10.2.1.0/24&#34;</span>
</span></span><span style="display:flex;"><span>  availability_zone <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ap-northeast-2a&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>resource <span style="color:#e6db74">&#34;aws_subnet&#34;</span> <span style="color:#e6db74">&#34;application_public_secondery&#34;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  vpc_id            <span style="color:#f92672">=</span> aws_vpc.application.id
</span></span><span style="display:flex;"><span>  cidr_block        <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;10.2.2.0/24&#34;</span>
</span></span><span style="display:flex;"><span>  availability_zone <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ap-northeast-2c&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Application Private Subnets</span>
</span></span><span style="display:flex;"><span>resource <span style="color:#e6db74">&#34;aws_subnet&#34;</span> <span style="color:#e6db74">&#34;application_private_primary&#34;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  vpc_id            <span style="color:#f92672">=</span> aws_vpc.application.id
</span></span><span style="display:flex;"><span>  cidr_block        <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;10.2.3.0/24&#34;</span>
</span></span><span style="display:flex;"><span>  availability_zone <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ap-northeast-2a&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>resource <span style="color:#e6db74">&#34;aws_subnet&#34;</span> <span style="color:#e6db74">&#34;application_private_secondery&#34;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  vpc_id            <span style="color:#f92672">=</span> aws_vpc.application.id
</span></span><span style="display:flex;"><span>  cidr_block        <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;10.2.4.0/24&#34;</span>
</span></span><span style="display:flex;"><span>  availability_zone <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ap-northeast-2c&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>VPC ë° Subnetì€ ë„¤íŠ¸ì›Œí¬ ë§ ë‚´ë¶€ì—ì„œ ì„±ê²©ì— ë§ëŠ” ì»´í“¨íŒ… ë¦¬ì†ŒìŠ¤ë¥¼ ê´€ë¦¬í•˜ê¸° ìœ„í•´ ì˜ì—­ì„ ë¶„ë¦¬í•˜ëŠ” ì‘ì—…ì— ì˜ë¯¸ë¥¼ ë‘”ë‹¤ê³  ìƒê°í•œë‹¤.</p>
<p>ì´ì œ ë¶„ë¦¬ëœ VPC ë‚´ë¶€ì—ì„œ ì¶œë°œì§€ì™€ ë„ì°©ì§€ë¥¼ ì§€ì •í•˜ì—¬ ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ì„ ë‚´ê°€ êµ¬ì„±í•œ ë„¤íŠ¸ì›Œí¬ ë§ ë‚´ë¶€ì— ëª©ì ì§€ì— ì˜ ë„ì°©í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •í•˜ëŠ” ì‘ì—…ì´ í•„ìš”í•˜ë‹¤.</p>
<h3 id="internet-gateway">Internet gateway</h3>
<p>Terraformì€ <code>aws_internet_gateway</code>ë¥¼ ì´ìš©í•´ VPC ë‚´ë¶€ì—ì„œ ì™¸ë¶€ ì¸í„°ë„·ì„ ì ‘ê·¼í•˜ê¸° ìœ„í•œ ì¸í„°ë„· ê²Œì´íŠ¸ì›Œí¬ë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤. ì´ë¥¼ í†µí•´ VPCëŠ” ì™¸ë¶€ ë„¤íŠ¸ì›Œí¬ì™€ í†µì‹ í•  ìˆ˜ ìˆìœ¼ë©°, ì™¸ë¶€ ë¦¬ì†ŒìŠ¤ì—ì„œ ì¸ë°”ìš´ë“œ íŠ¸ë˜í”½ì„ ìˆ˜ì‹ í•  ìˆ˜ ìˆë‹¤.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>resource <span style="color:#e6db74">&#34;aws_internet_gateway&#34;</span> <span style="color:#e6db74">&#34;dmz&#34;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  vpc_id <span style="color:#f92672">=</span> aws_vpc.dmz.id
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  tags <span style="color:#f92672">=</span> <span style="color:#f92672">{</span> Name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;DMZ Internet Gateway&#34;</span> <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>resource <span style="color:#e6db74">&#34;aws_internet_gateway&#34;</span> <span style="color:#e6db74">&#34;application&#34;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  vpc_id <span style="color:#f92672">=</span> aws_vpc.application.id
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  tags <span style="color:#f92672">=</span> <span style="color:#f92672">{</span> Name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Application Internet Gateway&#34;</span> <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>resource <span style="color:#e6db74">&#34;aws_route&#34;</span> <span style="color:#e6db74">&#34;dmz_public&#34;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  route_table_id         <span style="color:#f92672">=</span> aws_vpc.dmz.default_route_table_id
</span></span><span style="display:flex;"><span>  destination_cidr_block <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0.0.0.0/0&#34;</span>
</span></span><span style="display:flex;"><span>  gateway_id             <span style="color:#f92672">=</span> aws_internet_gateway.dmz.id
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>resource <span style="color:#e6db74">&#34;aws_route&#34;</span> <span style="color:#e6db74">&#34;applicaton_public&#34;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  route_table_id         <span style="color:#f92672">=</span> aws_vpc.application.default_route_table_id
</span></span><span style="display:flex;"><span>  destination_cidr_block <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0.0.0.0/0&#34;</span>
</span></span><span style="display:flex;"><span>  gateway_id             <span style="color:#f92672">=</span> aws_internet_gateway.application.id
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>ìƒì„±í•œ <code>aws_internet_gateway</code>ì€ ì•ì„œ ìƒì„±í•œ DMZ/Application VPCë¥¼ í†µì‹ í•  ìˆ˜ ìˆëŠ” ë¼ìš°íŒ… ê·œì¹™ì„ ì¶”ê°€í•œë‹¤.</p>
<h2 id="route-table">Route table</h2>
<p>ë¨¼ì € AWSì—ì„œ VPCë¥¼ ìƒì„±í•˜ë©´ ê¸°ë³¸ì ìœ¼ë¡œ route tableì´ ìƒì„±ë˜ê²Œ ëœë‹¤. ë”°ë¼ì„œ terraform ë‚´ë¶€ì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ìƒì„±ëœ route tableì„ ê´€ë¦¬í•˜ê¸° ìœ„í•´ì„œ terrafromì—ì„œëŠ” <code>aws_default_route_table</code>ì„ ì œê³µí•œë‹¤.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>resource <span style="color:#e6db74">&#34;aws_default_route_table&#34;</span> <span style="color:#e6db74">&#34;application_main&#34;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  default_route_table_id <span style="color:#f92672">=</span> aws_vpc.application.default_route_table_id
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  tags <span style="color:#f92672">=</span> <span style="color:#f92672">{</span> Name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;default public route table&#34;</span> <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>resource <span style="color:#e6db74">&#34;aws_route_table&#34;</span> <span style="color:#e6db74">&#34;application_private&#34;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  vpc_id <span style="color:#f92672">=</span> aws_vpc.application.id
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  tags <span style="color:#f92672">=</span> <span style="color:#f92672">{</span> Name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;default private route table&#34;</span> <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h2 id="nat">NAT</h2>
<p>NAT(Network Address Translation)ì€ IPv4 ë„¤íŠ¸ì›Œí¬ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ ì œí•œëœ ê³µì¸ IP ê°œìˆ˜ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ë°°ë¶„í•˜ê¸° ìœ„í•œ ë°©ë²•ì´ë‹¤. NATëŠ” ì™¸ë¶€ì™€ í†µì‹ í•˜ê¸° ìœ„í•œ IP í•˜ë‚˜ë§Œ í• ë‹¹ë°›ì€ ìƒíƒœì—ì„œ ë§ì€ í•˜ìœ„ PCê°€ ë„¤íŠ¸ì›Œí¬ì™€ í†µì‹ í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì¤€ë‹¤. NATë¥¼ ì‚¬ìš©í•  ê²½ìš° ë‚´ë¶€ PCë¥¼ ì™¸ë¶€ì—ì„œ ì§ì ‘ ì ‘ê·¼í•  ìˆ˜ ì—†ìœ¼ë©°, ì´ë¡œ ì¸í•´ ë³´ì•ˆì ì¸ ì¸¡ë©´ë„ ìƒí–¥í•  ìˆ˜ ìˆë‹¤.</p>
<p>Terraformì€ <code>aws_nat_gateway</code>ë¥¼ ì´ìš©í•´ ë¦¬ì†ŒìŠ¤ë¥¼ ì •ì˜í•  ìˆ˜ ìˆìœ¼ë©° ì—¬ê¸°ì„  NATê°€ ì‚¬ìš©í•  ê³µì¸ IPë¥¼ í•˜ë‚˜ í• ë‹¹ë°›ëŠ”ë‹¤.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>resource <span style="color:#e6db74">&#34;aws_eip&#34;</span> <span style="color:#e6db74">&#34;application_nat&#34;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  domain <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;vpc&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  depends_on <span style="color:#f92672">=</span> <span style="color:#f92672">[</span>aws_internet_gateway.dmz, aws_internet_gateway.application<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>resource <span style="color:#e6db74">&#34;aws_nat_gateway&#34;</span> <span style="color:#e6db74">&#34;application&#34;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  allocation_id <span style="color:#f92672">=</span> aws_eip.application_nat.id
</span></span><span style="display:flex;"><span>  subnet_id     <span style="color:#f92672">=</span> aws_subnet.application_public_1a.id
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  depends_on <span style="color:#f92672">=</span> <span style="color:#f92672">[</span>aws_internet_gateway.dmz, aws_internet_gateway.application<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div>
</article>

            </div>
        </main>
    </body></html>
